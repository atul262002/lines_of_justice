<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lines of Justice: A Survivor's Story</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Source+Sans+Pro:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary-teal: #2d7d7b;
        --accent-teal: #4a9b8e;
        --soft-purple: #7b68ee;
        --deep-purple: #5d4e9c;
        --warm-red: #d73a4f;
        --gold: #ffb800;
        --bg-cream: #fffdf8;
        --bg-warm: #f9f7f4;
        --text-charcoal: #1e1e24;
        --text-gray: #5a5a6e;
        --shadow: rgba(94, 84, 142, 0.12);
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      body {
        font-family: "Source Sans Pro", -apple-system, BlinkMacSystemFont,
          "Segoe UI", Roboto, sans-serif;
        background: var(--bg-cream);
        color: var(--text-charcoal);
        height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        position: fixed;
        width: 100%;
        top: 0;
        left: 0;
      }

      /* Start Screen */
      .start-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        background: linear-gradient(
          135deg,
          var(--deep-purple) 0%,
          var(--primary-teal) 100%
        );
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        animation: fadeIn 0.6s ease-out;
        overflow: hidden;
      }

      /* Butterfly Animation */
      .butterfly {
        animation: hover 250ms cubic-bezier(0.48, 0.01, 0.54, 1) infinite,
          butterflyFlyIn 3s ease-out forwards;
        animation-direction: alternate, normal;
        animation-fill-mode: reverse, forwards;
        position: absolute;
        transform-style: preserve-3d;
        transform: rotateX(50deg) rotateY(20deg) rotateZ(-50deg) translateY(0px);
        width: 30px;
        top: -100px;
        left: 50%;
        z-index: 1001;
      }

      .butterfly::before {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        content: "";
        display: block;
        height: 110px;
        left: 50%;
        margin-left: -10px;
        outline: 1px solid transparent;
        position: absolute;
        top: -15px;
        transform: rotatey(100deg);
        width: 20px;
        z-index: 2;
      }

      .wing {
        background: transparent;
        display: block;
        opacity: 0.9;
        outline: 1px solid transparent;
        position: absolute;
        top: 0;
      }

      .wing:first-child {
        animation: leftflap 250ms cubic-bezier(0.48, 0.01, 0.54, 1) infinite;
        animation-direction: alternate;
        animation-fill-mode: reverse;
        height: 1px;
        left: 0;
        transform: rotateY(-20deg);
        transform-origin: 700% 50%;
        width: 1px;
        z-index: 3;
      }

      .wing:last-child {
        animation: rightflap 250ms cubic-bezier(0.48, 0.01, 0.54, 1) infinite;
        animation-direction: alternate;
        animation-fill-mode: reverse;
        right: 0;
        transform: rotateY(200deg);
        z-index: 1;
      }

      .wing .bit {
        background: rgba(255, 255, 255, 0.8);
      }

      .wing .bit::after {
        background: rgba(255, 255, 255, 0.6);
      }

      .wing .bit,
      .wing .bit::after {
        border-radius: 50%;
        overflow: hidden;
        position: absolute;
        right: 0;
        top: 0;
        transform-origin: 100% 50%;
      }

      .wing .bit:first-child {
        height: 70px;
        text-align: center;
        top: 15px;
        transform: rotateZ(40deg);
        width: 130px;
      }

      .wing .bit:first-child::after {
        content: "";
        display: inline-block;
        height: 60px;
        left: -30px;
        top: 5px;
        width: 100px;
      }

      .wing .bit:last-child {
        height: 55px;
        transform: rotateZ(-40deg);
        width: 100px;
      }

      .wing .bit:last-child::after {
        content: "";
        display: inline-block;
        height: 45px;
        left: -24px;
        top: 5px;
        width: 60px;
        z-index: 1;
      }

      @keyframes butterflyFlyIn {
        0% {
          top: -100px;
          left: 50%;
          transform: rotateX(50deg) rotateY(20deg) rotateZ(-50deg)
            translateX(-50%);
        }
        50% {
          top: 40%;
          left: 60%;
          transform: rotateX(50deg) rotateY(20deg) rotateZ(-50deg)
            translateX(-50%);
        }
        100% {
          top: 15%;
          left: 85%;
          transform: rotateX(50deg) rotateY(20deg) rotateZ(-50deg)
            translateX(-50%);
        }
      }

      @keyframes hover {
        0% {
          transform: rotateX(50deg) rotateY(20deg) rotateZ(-50deg)
            translateZ(0px);
        }
        100% {
          transform: rotateX(50deg) rotateY(20deg) rotateZ(-50deg)
            translateZ(-3px);
        }
      }

      @keyframes leftflap {
        0% {
          transform: rotateY(-20deg);
        }
        100% {
          transform: rotateY(90deg);
        }
      }

      @keyframes rightflap {
        0% {
          transform: rotateY(200deg);
        }
        100% {
          transform: rotateY(90deg);
        }
      }

      @keyframes butterflyFlyOut {
        0% {
          top: 15%;
          left: 85%;
          transform: rotateX(50deg) rotateY(20deg) rotateZ(-50deg)
            translateX(-50%);
          opacity: 1;
        }
        100% {
          top: -200px;
          left: 120%;
          transform: rotateX(50deg) rotateY(20deg) rotateZ(-50deg)
            translateX(-50%) scale(0.3);
          opacity: 0;
        }
      }

      .butterfly-exit {
        animation: butterflyFlyOut 1s ease-in forwards !important;
      }

      .start-content {
        text-align: center;
        color: white;
        padding: 40px;
        max-width: 700px;
      }

      .start-title {
        font-size: 48px;
        font-weight: 700;
        margin-bottom: 20px;
        font-family: "Poppins", sans-serif;
        text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      }

      .start-subtitle {
        font-size: 20px;
        margin-bottom: 30px;
        opacity: 0.95;
        line-height: 1.6;
      }

      .start-description {
        font-size: 16px;
        margin-bottom: 40px;
        opacity: 0.9;
        line-height: 1.7;
      }

      .play-button {
        background: white;
        color: var(--deep-purple);
        border: none;
        padding: 20px 50px;
        border-radius: 50px;
        font-size: 20px;
        font-weight: 700;
        cursor: pointer;
        transition: var(--transition);
        font-family: "Poppins", sans-serif;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .play-button:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
      }

      .play-button:active {
        transform: translateY(-2px) scale(1.02);
      }

      /* Enhanced HUD with Glassmorphism */
      .hud {
        background: rgba(255, 255, 255, 0.92);
        backdrop-filter: blur(12px);
        padding: 12px 20px;
        box-shadow: 0 2px 16px var(--shadow);
        z-index: 100;
        position: relative;
      }

      .metrics-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        gap: 12px;
        flex-wrap: wrap;
      }

      .metric {
        flex: 1;
        min-width: 80px;
        text-align: center;
        transition: var(--transition);
      }

      .metric:hover {
        transform: translateY(-2px);
      }

      .metric-icon {
        font-size: 22px;
        margin-bottom: 4px;
        display: block;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
      }

      .metric-label {
        font-size: 9px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--text-gray);
        margin-bottom: 6px;
        font-family: "Poppins", sans-serif;
      }

      .metric-bar-container {
        background: var(--bg-warm);
        height: 8px;
        border-radius: 4px;
        overflow: hidden;
        position: relative;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
      }

      .metric-bar {
        height: 100%;
        border-radius: 4px;
        transition: var(--transition);
        position: relative;
      }

      /* Unique gradient colors per metric */
      .bar-safety {
        background: linear-gradient(
          90deg,
          var(--primary-teal) 0%,
          #6bc5b8 100%
        );
      }
      .bar-health {
        background: linear-gradient(90deg, #b53a4f 0%, #e85a6c 100%);
      }
      .bar-money {
        background: linear-gradient(90deg, #e89a26 0%, var(--gold) 100%);
      }
      .bar-child {
        background: linear-gradient(
          90deg,
          var(--deep-purple) 0%,
          var(--soft-purple) 100%
        );
      }
      .bar-justice {
        background: linear-gradient(90deg, #2a4faa 0%, #4a6b8a 100%);
      }

      /* Main Game Area */
      .game-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        height: calc(100vh - 70px);
      }

      .card-container {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 12px;
        overflow: hidden;
      }

      /* Enhanced Card with animations */
      .card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 12px 40px var(--shadow);
        max-width: 1000px;
        width: 100%;
        overflow: hidden;
        position: relative;
        height: 100%;
        max-height: calc(100vh - 100px);
        display: flex;
        flex-direction: column;
        position: relative;
        overflow: hidden;
      }

      .card-background {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-size: cover;
        background-position: center;
        z-index: 0;
      }

      .card-background::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.92) 0%,
          rgba(255, 255, 255, 0.88) 100%
        );
      }

      .card.slide-out-left {
        animation: slideOutLeft 0.4s ease-in forwards;
      }

      .card.slide-out-right {
        animation: slideOutRight 0.4s ease-in forwards;
      }

      .card.slide-in-left {
        animation: slideInLeft 0.5s ease-out;
      }

      .card.slide-in-right {
        animation: slideInRight 0.5s ease-out;
      }

      .card.fade-in {
        animation: fadeIn 0.6s ease-out;
      }

      .card.zoom-in {
        animation: zoomIn 0.5s ease-out;
      }

      .card.flip-in {
        animation: flipIn 0.6s ease-out;
      }

      @keyframes slideOutLeft {
        from {
          opacity: 1;
          transform: translateX(0);
        }
        to {
          opacity: 0;
          transform: translateX(-100%);
        }
      }

      @keyframes slideOutRight {
        from {
          opacity: 1;
          transform: translateX(0);
        }
        to {
          opacity: 0;
          transform: translateX(100%);
        }
      }

      @keyframes slideInLeft {
        from {
          opacity: 0;
          transform: translateX(-100%);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(100%);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes zoomIn {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes flipIn {
        from {
          opacity: 0;
          transform: rotateY(-90deg);
        }
        to {
          opacity: 1;
          transform: rotateY(0);
        }
      }

      .card-content-wrapper {
        display: flex;
        flex-direction: row;
        flex: 1;
        overflow: hidden;
        position: relative;
        z-index: 1;
      }

      .card-content-wrapper.image-right {
        flex-direction: row-reverse;
      }

      /* Images with subtle gradient overlay */
      .card-image {
        width: 40%;
        object-fit: cover;
        position: relative;
      }

      .card-content {
        width: 60%;
        padding: 24px;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        overflow-y: auto;
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(4px);
        margin: 16px;
        border-radius: 12px;
        max-height: calc(100% - 32px);
      }

      .card-content::-webkit-scrollbar {
        width: 6px;
      }

      .card-content::-webkit-scrollbar-track {
        background: var(--bg-warm);
        border-radius: 3px;
      }

      .card-content::-webkit-scrollbar-thumb {
        background: var(--accent-teal);
        border-radius: 3px;
      }

      .card-title {
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 16px;
        color: var(--text-charcoal);
        line-height: 1.3;
        font-family: "Poppins", sans-serif;
        letter-spacing: -0.3px;
      }

      .card-text {
        font-size: 15px;
        line-height: 1.6;
        color: var(--text-gray);
        margin-bottom: 16px;
      }

      .dialogue {
        background: var(--bg-warm);
        padding: 14px 14px 14px 32px;
        border-radius: 8px;
        font-style: italic;
        margin-bottom: 16px;
        color: var(--text-charcoal);
        font-weight: 500;
        position: relative;
        font-size: 14px;
      }

      .dialogue::before {
        content: '"';
        position: absolute;
        top: 8px;
        left: 10px;
        font-size: 36px;
        color: var(--soft-purple);
        opacity: 0.15;
        font-family: "Poppins", sans-serif;
        line-height: 1;
      }

      .stats-panel {
        background: var(--bg-warm);
        padding: 12px;
        border-radius: 8px;
        margin-top: 12px;
        font-size: 12px;
        color: var(--text-gray);
        border-left: 3px solid var(--gold);
      }

      .choices-container {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: auto;
        padding-top: 12px;
      }

      .choice-button {
        background: white;
        border: 2px solid var(--accent-teal);
        padding: 14px 18px;
        border-radius: 12px;
        cursor: pointer;
        transition: var(--transition);
        font-size: 14px;
        font-weight: 600;
        text-align: left;
        color: var(--text-charcoal);
        position: relative;
        overflow: hidden;
        font-family: "Source Sans Pro", sans-serif;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }

      .choice-button:hover {
        background: var(--accent-teal);
        color: white;
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(74, 155, 142, 0.25);
        border-color: var(--primary-teal);
      }

      .choice-button:active {
        transform: translateY(0);
      }

      /* Ending Screen */
      .ending-screen {
        background: white;
        border-radius: 16px;
        box-shadow: 0 12px 40px var(--shadow);
        max-width: 700px;
        width: 100%;
        padding: 36px 28px;
        text-align: center;
        animation: zoomIn 0.6s ease-out;
        overflow-y: auto;
        max-height: calc(100vh - 100px);
      }

      .ending-screen::-webkit-scrollbar {
        width: 6px;
      }

      .ending-screen::-webkit-scrollbar-track {
        background: var(--bg-warm);
        border-radius: 3px;
      }

      .ending-screen::-webkit-scrollbar-thumb {
        background: var(--accent-teal);
        border-radius: 3px;
      }

      .ending-title {
        font-size: 32px;
        font-weight: 700;
        margin-bottom: 20px;
        color: var(--text-charcoal);
        font-family: "Poppins", sans-serif;
      }

      .ending-outcome {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 20px;
        padding: 12px 24px;
        border-radius: 8px;
        display: inline-block;
        font-family: "Poppins", sans-serif;
      }

      .ending-outcome.justice {
        background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%);
        color: white;
      }

      .ending-outcome.partial {
        background: linear-gradient(135deg, #ffa726 0%, #ffb74d 100%);
        color: white;
      }

      .ending-outcome.survival {
        background: linear-gradient(135deg, #ff9800 0%, #ffb74d 100%);
        color: white;
      }

      .ending-outcome.collapse {
        background: linear-gradient(135deg, #e53935 0%, #ef5350 100%);
        color: white;
      }

      .ending-description {
        font-size: 16px;
        line-height: 1.7;
        color: var(--text-gray);
        margin-bottom: 24px;
      }

      .ending-notes {
        background: var(--bg-warm);
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 24px;
        text-align: left;
      }

      .ending-notes h3 {
        font-size: 16px;
        margin-bottom: 12px;
        font-family: "Poppins", sans-serif;
      }

      .ending-notes ul {
        list-style: none;
        padding-left: 0;
      }

      .ending-notes li {
        padding: 6px 0;
        font-size: 14px;
        color: var(--text-gray);
        padding-left: 20px;
        position: relative;
      }

      .ending-notes li::before {
        content: "â€¢";
        position: absolute;
        left: 0;
        color: var(--soft-purple);
        font-weight: bold;
      }

      .restart-button {
        background: linear-gradient(
          135deg,
          var(--deep-purple) 0%,
          var(--soft-purple) 100%
        );
        color: white;
        border: none;
        padding: 16px 32px;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 700;
        cursor: pointer;
        transition: var(--transition);
        font-family: "Poppins", sans-serif;
        box-shadow: 0 4px 20px rgba(109, 93, 208, 0.3);
      }

      .restart-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 25px rgba(109, 93, 208, 0.4);
      }

      /* Responsive Design */
      @media (max-width: 1024px) {
        .card {
          max-width: 100%;
        }

        .card-title {
          font-size: 22px;
        }

        .card-image {
          width: 35%;
        }

        .card-content {
          width: 65%;
        }
      }

      @media (max-width: 768px) {
        .hud {
          padding: 8px 12px;
        }

        .metric {
          min-width: 70px;
        }

        .metric-icon {
          font-size: 18px;
        }

        .metric-label {
          font-size: 8px;
        }

        .card-container {
          padding: 8px;
        }

        .card-content-wrapper {
          flex-direction: column !important;
        }

        .card-image {
          width: 100%;
          height: 180px;
          min-height: 180px;
        }

        .card-content {
          width: 100%;
          padding: 20px;
        }

        .card-title {
          font-size: 20px;
          margin-bottom: 12px;
        }

        .card-text {
          font-size: 14px;
          margin-bottom: 12px;
        }

        .dialogue {
          font-size: 13px;
          padding: 12px 12px 12px 28px;
          margin-bottom: 12px;
        }

        .choice-button {
          padding: 12px 16px;
          font-size: 13px;
        }

        .ending-screen {
          padding: 28px 20px;
        }

        .ending-title {
          font-size: 26px;
        }

        .ending-outcome {
          font-size: 18px;
        }

        .start-title {
          font-size: 36px;
        }

        .start-subtitle {
          font-size: 18px;
        }

        .start-description {
          font-size: 14px;
        }

        .butterfly {
          transform: scale(0.7);
        }

        @keyframes butterflyFlyIn {
          0% {
            top: -100px;
            left: 50%;
          }
          50% {
            top: 30%;
            left: 50%;
          }
          100% {
            top: 10%;
            left: 80%;
          }
        }
      }

      @media (max-width: 480px) {
        .metrics-container {
          gap: 6px;
        }

        .metric {
          min-width: 60px;
        }

        .metric-icon {
          font-size: 16px;
        }

        .card-content {
          padding: 16px;
          margin: 0px;
        }

        .card-title {
          font-size: 18px;
        }

        .card-text {
          font-size: 13px;
        }

        .choice-button {
          font-size: 12px;
          padding: 10px 14px;
        }

        .start-content {
          padding: 30px 20px;
        }

        .start-title {
          font-size: 28px;
        }

        .play-button {
          padding: 16px 40px;
          font-size: 16px;
        }

        .butterfly {
          transform: scale(0.6);
        }

        @keyframes butterflyFlyIn {
          0% {
            top: -100px;
            left: 50%;
          }
          50% {
            top: 25%;
            left: 50%;
          }
          100% {
            top: 8%;
            left: 75%;
          }
        }
      }

      /* Subtle background pattern */
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: radial-gradient(
          circle at 10% 20%,
          rgba(122, 219, 212, 0.03) 0%,
          transparent 20%
        );
        pointer-events: none;
        z-index: -1;
      }

      .hidden {
        display: none !important;
      }
      /* Parameter Change Animation */
      .metric-change {
        position: absolute;
        top: -25px;
        left: 50%;
        transform: translateX(-50%);
        font-weight: 700;
        font-size: 16px;
        animation: floatUp 1.5s ease-out forwards;
        pointer-events: none;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        font-family: "Poppins", sans-serif;
        z-index: 10;
      }

      .metric-change.positive {
        color: #4caf50;
      }

      .metric-change.negative {
        color: #e53935;
      }

      @keyframes floatUp {
        0% {
          opacity: 1;
          transform: translateX(-50%) translateY(0);
        }
        100% {
          opacity: 0;
          transform: translateX(-50%) translateY(-30px);
        }
      }

      /* Metric pulse animation */
      .metric.pulse-positive {
        animation: pulseGreen 0.6s ease-out;
      }

      .metric.pulse-negative {
        animation: pulseRed 0.6s ease-out;
      }

      @keyframes pulseGreen {
        0%,
        100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(76, 175, 80, 0);
        }
        50% {
          transform: scale(1.05);
          box-shadow: 0 0 0 8px rgba(76, 175, 80, 0.4);
        }
      }

      @keyframes pulseRed {
        0%,
        100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(229, 57, 53, 0);
        }
        50% {
          transform: scale(1.05);
          box-shadow: 0 0 0 8px rgba(229, 57, 53, 0.4);
        }
      }

      /* Bar fill animation */
      .metric-bar.animate-change {
        transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      }

      /* Enhanced metric container */
      .metric {
        position: relative;
        background: rgba(255, 255, 255, 0.5);
        padding: 8px;
        border-radius: 8px;
      }

      /* Blue-toned overlay for images to match your color scheme */
      .card-image::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          135deg,
          rgba(45, 125, 123, 0.2) 0%,
          rgba(93, 78, 156, 0.25) 100%
        );
        pointer-events: none;
      }

      /* Choice button selected state */
      .choice-button.selected {
        background: linear-gradient(
          135deg,
          var(--primary-teal) 0%,
          var(--deep-purple) 100%
        );
        color: white;
        border-color: var(--primary-teal);
        transform: scale(0.95);
      }
      .metric-change {
        font-size: 14px;
        top: -20px;
      }

      .metric {
        padding: 6px;
      }
    </style>
  </head>
  <body>
    <div id="startScreen" class="start-screen">
      <div class="butterfly">
        <div class="wing">
          <div class="bit"></div>
          <div class="bit"></div>
        </div>
        <div class="wing">
          <div class="bit"></div>
          <div class="bit"></div>
        </div>
      </div>
      <div class="start-content">
        <h1 class="start-title">Lines of Justice</h1>
        <p class="start-subtitle">A Survivor's Story</p>
        <p class="start-description">
          Navigate the complex journey of seeking justice in the face of
          domestic violence. Your choices will impact safety, health, financial
          stability, and your child's well-being. Every decision matters.
        </p>
        <button class="play-button" onclick="startGame()">Play Game</button>
      </div>
    </div>

    <div id="app" class="hidden"></div>

    <script>
      // Animation types to cycle through
      const animations = [
        "slide-in-left",
        "slide-in-right",
        "zoom-in",
        "fade-in",
        "flip-in",
      ];
      let currentAnimationIndex = 0;

      // Game Data
      const gameData = {
        metrics: {
          safety: { name: "Safety", value: 5, max: 10, icon: "ðŸ›¡ï¸" },
          health: { name: "Health", value: 5, max: 10, icon: "â¤ï¸" },
          money: { name: "Money", value: 5, max: 10, icon: "ðŸ’°" },
          child: { name: "Child Well-being", value: 5, max: 10, icon: "ðŸ§¸" },
          justice: { name: "Justice Progress", value: 5, max: 10, icon: "âš–ï¸" },
        },
        currentScene: 0,
        scenes: [
          {
            id: 1,
            title: "Violence at Home",
            image: "./images/1.jpg",
            background:
              "linear-gradient(rgba(183,58,79,0.3), rgba(45,125,123,0.2)), url('https://images.unsplash.com/photo-1497942304796-b8bc2c4f5b95?w=1000&h=600&fit=crop')",
            imagePosition: "left",
            text: "It's late night. Your partner lashes out violently again. Your child clings to you, crying. You know this can't go on, but what can you do tonight?",
            stats:
              "4,48,211 cases of crime against women were registered in 2023 (NCRB). 'Cruelty by Husband or Relatives' accounted for 29.8%.",
            choices: [
              {
                text: "Stay home and hope it calms down.",
                effects: { safety: -2, health: -1 },
                nextScene: 1,
              },
              {
                text: "Take your child and walk to a nearby NGO shelter.",
                effects: { money: -1, safety: 2 },
                nextScene: 1,
              },
              {
                text: "Call the police station.",
                effects: { justice: 1 },
                nextScene: 1,
                random: { safety: [1, -1] },
              },
            ],
          },
          {
            id: 2,
            title: "Shelter & Child Care",
            image: "./images/2.jpg",
            background:
              "linear-gradient(rgba(109,93,208,0.2), rgba(123,104,238,0.15)), url('https://images.unsplash.com/photo-1559027615-cd4628902d4a?w=1000&h=600&fit=crop')",
            imagePosition: "right",
            dialogue:
              '"We can offer you a bed tonight. But for you to attend legal counseling tomorrow, your child should stay at our daycare. Will you agree?"',
            choices: [
              {
                text: "Keep child with you.",
                effects: { child: -1, safety: 1 },
                nextScene: 2,
              },
              {
                text: "Leave child at daycare.",
                effects: { child: 1, money: -1 },
                nextScene: 2,
                note: "Costs â‚¹50/day",
              },
            ],
          },
          {
            id: 3,
            title: "Access to Legal Aid",
            image: "./images/3.jpg",
            background:
              "linear-gradient(rgba(42,79,170,0.25), rgba(74,107,138,0.2)), url('https://images.unsplash.com/photo-1450101499163-c8848c66ca85?w=1000&h=600&fit=crop')",
            imagePosition: "left",
            text: "A PLV will be in your locality, conducting a legal awareness session. Today you can either take informal cleaning work, or attend the session.",
            stats:
              "Access to legal aid varies greatly across regions, affecting justice outcomes.",
            choices: [
              {
                text: "Take the cleaning job (â‚¹200).",
                effects: { money: 2, health: -1 },
                nextScene: 3,
              },
              {
                text: "Attend legal aid awareness session.",
                effects: { justice: 2, money: -2 },
                nextScene: 3,
              },
              {
                text: "Ask your community for help.",
                effects: { money: 1 },
                nextScene: 3,
                random: { money: [1, 0], safety: [0, -1] },
              },
            ],
          },
          {
            id: 4,
            title: "Police Station",
            image: "./images/4.jpg",
            background:
              "linear-gradient(rgba(94,84,142,0.3), rgba(45,125,123,0.25)), url('https://images.unsplash.com/photo-1551818011-88051982c178?w=1000&h=600&fit=crop')",
            imagePosition: "right",
            dialogue:
              '"Show me your ID first. And you knowâ€¦ in matrimonial matters, it\'s better to settle and keep the family together."',
            stats:
              "Low rates of reporting in DV cases are common due to systemic barriers.",
            choices: [
              {
                text: "Agree to mediation at the risk of facing husband.",
                effects: { justice: 1 },
                nextScene: 4,
                random: { justice: [1, 0], safety: [-2, 0] },
              },
              {
                text: "Return with NGO staff tomorrow.",
                effects: { justice: 1, safety: 2, money: -1 },
                nextScene: 4,
              },
            ],
          },
          {
            id: 5,
            title: "Medical Evidence",
            image: "./images/5.jpg",
            background:
              "linear-gradient(rgba(183,58,79,0.2), rgba(232,90,108,0.15)), url('https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?w=1000&h=600&fit=crop')",
            imagePosition: "left",
            text: "The court asks for medical proof of injuries. Public hospital is free but discriminatory. A private clinic is kinder, but costs.",
            choices: [
              {
                text: "Go to public hospital.",
                effects: { justice: 1, health: 1, child: -1 },
                nextScene: 5,
              },
              {
                text: "Pay private clinic (â‚¹1,000).",
                effects: { money: -3, justice: 2, health: 2 },
                nextScene: 5,
              },
              { text: "Skip exam.", effects: { justice: -2 }, nextScene: 5 },
            ],
          },
          {
            id: 6,
            title: "Court Hearing",
            image: "./images/6.jpg",
            background:
              "linear-gradient(rgba(42,79,170,0.3), rgba(74,107,138,0.25)), url('https://images.unsplash.com/photo-1505664199159-4d4b396c22b8?w=1000&h=600&fit=crop')",
            imagePosition: "right",
            dialogue:
              '"Maintain silence in the courtroom! If you can\'t manage your child, wait outside until your matter is called."',
            choices: [
              {
                text: "Take child inside anyway.",
                effects: { child: -1, justice: 1 },
                nextScene: 6,
              },
              {
                text: "Miss the hearing.",
                effects: { justice: -2, safety: -1 },
                nextScene: 6,
              },
              {
                text: "Seek volunteer/anganwadi worker to watch child.",
                effects: { child: 1, justice: 1 },
                nextScene: 6,
              },
            ],
          },
          {
            id: 7,
            title: "Threats from Abuser's Family",
            image: "./images/7.jpg",
            background:
              "linear-gradient(rgba(183,58,79,0.35), rgba(229,57,53,0.25)), url('https://images.unsplash.com/photo-1535778626772-88723fb11334?w=1000&h=600&fit=crop')",
            imagePosition: "left",
            dialogue:
              "\"Withdraw the case, or we'll make sure you regret it. You can't just drag your family matters in front of everyone.\"",
            choices: [
              {
                text: "Ask police for protection.",
                effects: { justice: 1, money: -1 },
                nextScene: 7,
                random: { safety: [2, 0] },
              },
              {
                text: "Stay hidden, skip court.",
                effects: { safety: 1, justice: -2 },
                nextScene: 7,
              },
              { text: "Confront them.", effects: { safety: -2 }, nextScene: 7 },
            ],
          },
          {
            id: 8,
            title: "Verdict / Resolution",
            image: "./images/8.jpg",
            background:
              "radial-gradient(circle at center, rgba(109,93,208,0.2) 0%, rgba(45,125,123,0.15) 100%), url('https://images.unsplash.com/photo-1589994962902-9e0300c5e0b0?w=1000&h=600&fit=crop')",
            imagePosition: "right",
            text: "The judge is delivering the final verdict...",
            choices: [],
          },
        ],
      };

      // Game Logic
      class Game {
        constructor() {
          this.metrics = JSON.parse(JSON.stringify(gameData.metrics));
          this.currentScene = 0;
          this.sceneHistory = [];
          this.choicesMade = [];
        }

        applyEffects(effects) {
          Object.entries(effects).forEach(([metric, change]) => {
            if (this.metrics[metric] && change !== 0) {
              const oldValue = this.metrics[metric].value;
              this.metrics[metric].value = Math.max(
                0,
                Math.min(
                  this.metrics[metric].max,
                  this.metrics[metric].value + change
                )
              );

              // Trigger animation
              this.animateMetricChange(metric, change, oldValue);
            }
          });
        }

        animateMetricChange(metricKey, change, oldValue) {
          // Wait for next render
          setTimeout(() => {
            const metricElement = document.querySelector(
              `.metric[data-metric="${metricKey}"]`
            );
            if (!metricElement) return;

            // Add floating number
            const changeIndicator = document.createElement("div");
            changeIndicator.className = `metric-change ${
              change > 0 ? "positive" : "negative"
            }`;
            changeIndicator.textContent = `${change > 0 ? "+" : ""}${change}`;
            metricElement.style.position = "relative";
            metricElement.appendChild(changeIndicator);

            // Add pulse animation
            metricElement.classList.add(
              change > 0 ? "pulse-positive" : "pulse-negative"
            );

            // Animate bar
            const bar = metricElement.querySelector(".metric-bar");
            if (bar) {
              bar.classList.add("animate-change");
            }

            // Clean up
            setTimeout(() => {
              changeIndicator.remove();
              metricElement.classList.remove(
                "pulse-positive",
                "pulse-negative"
              );
            }, 1500);
          }, 50);
        }

        applyRandomEffect(effect) {
          Object.entries(effect).forEach(([metric, possibleValues]) => {
            const randomValue =
              possibleValues[Math.floor(Math.random() * possibleValues.length)];
            if (this.metrics[metric]) {
              this.metrics[metric].value = Math.max(
                0,
                Math.min(
                  this.metrics[metric].max,
                  this.metrics[metric].value + randomValue
                )
              );
            }
          });
        }

        getEnding() {
          const avgMetric =
            Object.values(this.metrics).reduce((sum, m) => sum + m.value, 0) /
            Object.keys(this.metrics).length;
          const justiceScore = this.metrics.justice.value;

          if (justiceScore >= 7 && avgMetric >= 6) {
            return {
              type: "justice",
              title: "Justice Achieved",
              description:
                "After navigating countless systemic barriers, Dhaani finally receives a protection order. The court grants her custody and shelter support. With legal recognition, she begins rebuilding her life.",
              notes: [
                "Challenges with maintenance order enforcement remain",
                "Rebuilding support structures requires sustained effort",
                "Societal stigma persists, especially for migrant women",
                "Continued legal aid crucial for stability",
              ],
            };
          } else if (justiceScore >= 5 && avgMetric >= 4) {
            return {
              type: "partial",
              title: "Partial Relief",
              description:
                "The case drags on, but Dhaani receives interim protection. NGO support keeps her afloat. Justice is delayed, but structural support prevents collapse.",
              notes: [
                "Prolonged proceedings create ongoing stress",
                "Interim measures provide temporary safety only",
                "Ecosystem support remains critical",
                "Financial instability threatens independence",
              ],
            };
          } else if (justiceScore >= 2 && this.metrics.child.value >= 4) {
            return {
              type: "survival",
              title: "Survival without Justice",
              description:
                "Exhausted by systemic demands, Dhaani withdraws the case to protect her child. She remains in shelter but faces an uncertain future.",
              notes: [
                "System retraumatization forces withdrawal",
                "Child safety prioritized over justice",
                "Lack of justice perpetuates vulnerability",
                "Economic independence remains elusive",
              ],
            };
          } else {
            return {
              type: "collapse",
              title: "Systemic Collapse",
              description:
                "The case is dismissed due to insufficient evidence. Without protection, Dhaani is forced back into her abusive environment.",
              notes: [
                "Systemic barriers prevent justice access",
                "Evidence challenges undermine the case",
                "No protection against retaliation",
                "Child safety severely compromised",
              ],
            };
          }
        }

        renderHUD() {
          const hudContainer = document.querySelector(".hud");
          if (!hudContainer) return;

          const metricsHTML = Object.entries(this.metrics)
            .map(
              ([key, metric]) => `
                    <div class="metric" data-metric="${key}">
                        <span class="metric-icon">${metric.icon}</span>
                        <div class="metric-label">${metric.name}</div>
                        <div class="metric-bar-container">
                            <div class="metric-bar bar-${key}" style="width: ${
                (metric.value / metric.max) * 100
              }%"></div>
                        </div>
                    </div>
                `
            )
            .join("");

          hudContainer.innerHTML = `<div class="metrics-container">${metricsHTML}</div>`;
        }

        getNextAnimation() {
          const animation = animations[currentAnimationIndex];
          currentAnimationIndex =
            (currentAnimationIndex + 1) % animations.length;
          return animation;
        }

        renderScene() {
          const app = document.getElementById("app");
          const scene = gameData.scenes[this.currentScene];

          if (!scene) return;

          if (scene.id === 8) {
            this.renderEnding();
            return;
          }

          const animation = this.getNextAnimation();

          const sceneHTML = `
                <div class="hud"></div>
                <div class="game-container">
                    <div class="card-container">
                        <div class="card ${animation}">
                            <div class="card-background" style="${
                              scene.background
                                ? `background: ${scene.background};`
                                : ""
                            }"></div>
                            <div class="card-content-wrapper ${
                              scene.imagePosition === "right"
                                ? "image-right"
                                : ""
                            }">
                                <img src="${scene.image}" alt="${
            scene.title
          }" class="card-image">
                                <div class="card-content">
                                    <h1 class="card-title">${scene.title}</h1>
                                    ${
                                      scene.dialogue
                                        ? `<div class="dialogue">${scene.dialogue}</div>`
                                        : ""
                                    }
                                    <p class="card-text">${scene.text}</p>
                                    ${
                                      scene.stats
                                        ? `<div class="stats-panel">${scene.stats}</div>`
                                        : ""
                                    }
                                    <div class="choices-container">
                                        ${scene.choices
                                          .map(
                                            (choice, index) => `
                                            <button class="choice-button" data-choice="${index}">
                                                ${choice.text}
                                                ${
                                                  choice.note
                                                    ? `<br><small style="opacity: 0.7; font-weight: 400;">${choice.note}</small>`
                                                    : ""
                                                }
                                            </button>
                                        `
                                          )
                                          .join("")}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

          app.innerHTML = sceneHTML;
          this.renderHUD();
          this.attachChoiceListeners();
        }
        attachChoiceListeners() {
          const buttons = document.querySelectorAll(".choice-button");
          buttons.forEach((button, index) => {
            button.addEventListener("click", () => this.makeChoice(index));
          });
        }

        makeChoice(choiceIndex) {
          const scene = gameData.scenes[this.currentScene];
          const choice = scene.choices[choiceIndex];

          // Highlight selected button
          const buttons = document.querySelectorAll(".choice-button");
          buttons[choiceIndex].classList.add("selected");

          this.choicesMade.push({
            scene: scene.title,
            choice: choice.text,
            effects: choice.effects,
          });

          if (choice.effects) {
            this.applyEffects(choice.effects);
          }

          if (choice.random) {
            this.applyRandomEffect(choice.random);
          }

          this.sceneHistory.push(this.currentScene);
          this.currentScene = choice.nextScene;

          // Disable all buttons to prevent multiple clicks
          buttons.forEach((btn) => (btn.disabled = true));

          setTimeout(() => {
            this.renderScene();
          }, 1200); // Increased delay to see animations
        }
        renderEnding() {
          const app = document.getElementById("app");
          const ending = this.getEnding();

          const endingHTML = `
                    <div class="hud"></div>
                    <div class="game-container">
                        <div class="card-container">
                            <div class="ending-screen">
                                <h1 class="ending-title">Lines of Justice: Journey's End</h1>
                                <div class="ending-outcome ${ending.type}">${
            ending.title
          }</div>
                                <p class="ending-description">${
                                  ending.description
                                }</p>
                                <div class="ending-notes">
                                    <h3>Key Challenges Identified:</h3>
                                    <ul>
                                        ${ending.notes
                                          .map((note) => `<li>${note}</li>`)
                                          .join("")}
                                    </ul>
                                </div>
                                <div class="stats-panel" style="text-align: left;">
                                    <strong>Final Status:</strong><br>
                                    ${Object.entries(this.metrics)
                                      .map(
                                        ([key, metric]) =>
                                          `${metric.name}: ${metric.value}/${metric.max}`
                                      )
                                      .join(" â€¢ ")}
                                </div>
                                <button class="restart-button" onclick="restartGame()">Play Again</button>
                            </div>
                        </div>
                    </div>
                `;

          app.innerHTML = endingHTML;
          this.renderHUD();
        }

        restart() {
          this.metrics = JSON.parse(JSON.stringify(gameData.metrics));
          this.currentScene = 0;
          this.sceneHistory = [];
          this.choicesMade = [];
          currentAnimationIndex = 0;
          this.renderScene();
        }

        start() {
          this.renderScene();
        }
      }

      let game;

      function startGame() {
        const butterfly = document.querySelector(".butterfly");
        const startScreen = document.getElementById("startScreen");

        // Trigger butterfly exit animation
        butterfly.classList.add("butterfly-exit");

        // Wait for animation to complete before transitioning to game
        setTimeout(() => {
          startScreen.classList.add("hidden");
          document.getElementById("app").classList.remove("hidden");
          game = new Game();
          game.start();
        }, 1000);
      }

      function restartGame() {
        document.getElementById("startScreen").classList.remove("hidden");
        document.getElementById("app").classList.add("hidden");
        window.location.reload();
        game = null;
      }

      window.addEventListener("DOMContentLoaded", () => {
        // Show start screen on load
      });
    </script>
  </body>
</html>
